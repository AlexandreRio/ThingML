/*
 * Copyright (C) 2014 SINTEF <franck.fleurey@sintef.no>
 *
 * Licensed under the GNU LESSER GENERAL PUBLIC LICENSE, Version 3, 29 June 2007;
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * 	http://www.gnu.org/licenses/lgpl-3.0.txt
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/* global describe, it */
var assert = require("assert"),
	state = require("../lib/state.com.js");
	
var model = new state.StateMachine( "history" );

var initial = new state.PseudoState( "initial", model, state.PseudoStateKind.Initial);
var shallow = new state.State( "shallow", model );
var deep = new state.State( "deep", model );
var end = new state.FinalState( "final", model );

var s1 = new state.State( "s1", shallow );
var s2 = new state.State( "s2", shallow );

initial.to(shallow);
new state.PseudoState( "shallow", shallow, state.PseudoStateKind.ShallowHistory).to( s1 );
s1.to(s2).when(function(c) { return c === "move";} );
shallow.to(deep).when(function(c) { return c === "go deep";} );
deep.to(shallow).when(function(c) { return c === "go shallow";} );
s2.to(end).when(function(c) { return c === "end"; } );

var instance = new state.StateMachineInstance("instance");

state.initialise(model, instance);

state.evaluate (model, instance, "move");
state.evaluate (model, instance, "go deep");
state.evaluate (model, instance, "go shallow");
state.evaluate (model, instance, "end");

describe("test/history.js", function () {
	it("Test should result in a completed state", function(){
		state.isComplete(model, instance);
	});
});